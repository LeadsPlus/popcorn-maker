(function(t,q,k){var m={},l=0,j=function(a){var b=[],g=l++,c=k,d=this,a=a||{},f=a.name||"Track"+Date.now();this.getName=function(){return f};this.getId=function(){return g};this.getTrackEvent=function(a){for(var c=0,g=b.length;c<g;++c)if(b[c].getId()===a||b[c].getName()===a)return b[c]};this.getTrackEvents=function(){return b};this.removeTrackEvent=function(a){typeof a==="string"&&(a=d.getTrackEvent(a));var g=b.indexOf(a);if(g>-1)b.splice(g,1),a.track=k,a.setButter(k),c.trigger("trackeventremoved",
a)};this.addTrackEvent=function(a){a instanceof h||(a=new h(a));b.push(a);a.track=d;a.setButter(c);c.trigger("trackeventadded",a);return a};this.setButter=function(a){c=a};this.getButter=function(){return c}},b=0,h=function(a){var c=b++,g=k,a=a||{},d=a.name||"Track"+Date.now();this.start=a.start||0;this.end=a.end||0;this.type=a.type;this.popcornOptions=a.popcornOptions;this.popcornEvent=a.popcornEvent;this.track=a.track;this.getName=function(){return d};this.getId=function(){return c};this.setButter=
function(a){g=a};this.getButter=function(){return g}},e=0,c=function(a){var b=e++,a=a||{},c=a.name||"Target"+b+Date.now();this.object=a.object;this.getName=function(){return c};this.getId=function(){return b}},d=0,f=function(a){var a=a||{},b={},c=[],f=d++,e=a.name||"Media"+f+Date.now(),h,o=k,p=0,i=0,s=this;this.setMedia=function(a){h=a;o&&o.trigger("mediacontentchanged",s)};a.media&&this.setMedia(a.media);this.getMedia=function(){return h};this.getName=function(){return e};this.getId=function(){return f};
this.getTracks=function(){return c};this.setButter=function(a){o=a};this.getButter=function(){return o};this.addTrack=function(a){a instanceof j||(a=new j(a));b[a.getName()]=a;c.push(a);a.setButter(o);for(var s=a.getTrackEvents(),d=0,f=s.length;d<f;++d)o.trigger("trackeventadded",s[d]);o&&o.trigger("trackadded",a);return a};this.getTrack=function(a){var s=b[a];if(s)return s;for(var s=0,d=c.length;s<d;++s)if(c[s].getName()===a)return c[s];return k};this.removeTrack=function(a){typeof a==="string"&&
(a=s.getTrack(a));var d=c.indexOf(a);if(d>-1){c.splice(d,1);a.setButter(k);delete b[a.getName()];for(var d=a.getTrackEvents(),f=0,e=d.length;f<e;++f)o.trigger("trackeventremoved",d[f]);o&&o.trigger("trackremoved",a);return a}return k};this.currentTime=function(a){a&&(p=a,o&&o.trigger("mediatimeupdate",s));return p};this.duration=function(a){a&&(i=a,o&&o.trigger("mediadurationchanged",s));return i}},u=0,i=function(){function a(){if(!e)throw Error("No media object is selected");}var b={},g=[],d={},
e,i=[],o={},p=this;this.id="Butter"+u++;this.trigger=function(a,c,d){c={type:a,domain:d,data:c};if(b[a])for(var g=0,e=b[a].length;g<e;++g)b[a][g].call(p,c,d);if(d&&(a+=d,b[a])){g=0;for(e=b[a].length;g<e;++g)b[a][g].call(p,c,d)}};this.listen=function(a,c,d){a+=d||"";b[a]||(b[a]=[]);b[a].push(c)};this.unlisten=function(a,c,d){a+=d||"";if(d=b[a])c?(a=d.indexOf(c),d.splice(a,1)):b[a]=[]};this.addTrackEvent=function(b,c){a();typeof b==="string"&&(b=e.getTrack(b));if(b)return c instanceof h||(c=new h(c)),
b.addTrackEvent(c),c;else throw Error("No valid track specified");};this.getTrackEvents=function(){a();for(var b=e.getTracks(),c={},d=0,g=b.length;d<g;++d){var f=b[d];c[f.getName()]=f.getTrackEvents()}return c};this.getTrackEvent=function(b,c){a();if(b&&c)return typeof b==="string"&&(b=p.getTrack(b)),b.getTrackEvent(c);else{var d=p.getTrackEvents(),g;for(g in d)for(var e=d[g],f=0,h=e.length;f<h;++f)if(e[f].getName()===b)return e[f]}};this.removeTrackEvent=function(b,c){a();if(!c)if(b instanceof h)c=
b,b=c.track;else if(typeof b==="string")c=p.getTrackEvent(b),b=c.track;else throw Error("Invalid parameters for removeTrackEvent");typeof b==="string"&&(b=p.getTrack(b));typeof c==="string"&&(c=b.getTrackEvent(c));b.removeTrackEvent(c);return c};this.addTrack=function(b){a();return e.addTrack(b)};this.getTracks=function(){a();return e.getTracks()};this.getTrack=function(b){a();return e.getTrack(b)};this.removeTrack=function(b){a();return e.removeTrack(b)};this.addTarget=function(a){a instanceof c||
(a=new c(a));o[a.getName()]=a;i.push(a);this.trigger("targetadded",a);return a};this.removeTarget=function(a){typeof a==="string"&&(a=p.getTarget(a));var b=i.indexOf(a);if(b>-1)return i.splice(b,1),delete i[a.getName()],butter.trigger("targetremoved",a),a;return k};this.getTargets=function(){return i};this.getTarget=function(a){return o[a]};this.importProject=function(){};this.exportProject=function(){};this.setProjectDetails=function(){};this.getProjectDetails=function(){};this.currentTime=function(b){a();
return e.currentTime(b)};this.duration=function(b){a();return e.duration(b)};this.getAllMedia=function(){return g};this.getMedia=function(a){if(d[a])return d[a];for(var b=0,c=g.length;b<c;++b)if(g[b].getName()===a)return g[b];return k};this.getCurrentMedia=function(){return e};this.setMedia=function(a){typeof a==="string"&&(a=p.getMedia(a));if(a&&g.indexOf(a)>-1)return e=a,p.trigger("mediachanged",a),e};this.addMedia=function(a){a instanceof f||(a=new f(a));var b=a.getName();g.push(a);d[b]=a;a.setButter(p);
p.trigger("mediaadded",a);e||p.setMedia(a);return a};this.removeMedia=function(a){typeof a==="string"&&(a=p.getMedia(a));var b=g.indexOf(a);if(b>-1)return g.splice(b,1),delete d[a.getName()],a.setButter(k),a===e&&(e=k),p.trigger("mediaremoved",a),a;return k};for(var j in m)m[j].setup&&m[j].setup.call(this)};i.getScriptLocation=function(){for(var a=q.querySelectorAll("script"),b=0;b<a.length;++b){var c=a[b].src.lastIndexOf("butter.js");if(c>-1)return a[b].src.substr(0,c)+"/"}};i.registerModule=i.prototype.registerModule=
function(a,b){i.prototype[a]=function(a){b.setup&&b.setup.call(this,a);return this};b.extend&&i.extendAPI(b.extend)};i.extendAPI=function(a){for(var b in a)a.hasOwnProperty(b)&&(i[b]=a[b],i.prototype[b]=a[b])};i.extend=function(a){var b=a;[].slice.call(arguments,1).forEach(function(a){for(var c in a)b[c]=a[c]})};i.Media=f;i.Track=j;i.TrackEvent=h;i.Target=c;t.Butter=i})(window,document,void 0);
(function(t,q,k,m){m.registerModule("comm",{setup:function(){},extend:{CommClient:function(l,j){var b={};t.addEventListener("message",function(h){if(h.source!==t){h=JSON.parse(h.data);if(h.type&&b[h.type])for(var e=b[h.type],c=0;c<e.length;++c)e[c](h.message);j&&j(h)}},!1);this.listen=function(h,e){if(h&&e)return b[h]||(b[h]=[]),b[h].push(e),e;else throw Error("Must provide a type and callback for CommClient listeners");};this.forget=function(h,e){if(e){var c=b[h].indexOf(e);if(c>-1)return e=b[h][c],
b.splice(c,1),e}else delete b[h]};this.send=function(b,e){e?postMessage(JSON.stringify({type:e,message:b}),"*"):postMessage(JSON.stringify(b),"*")}},CommServer:function(){function l(b,e,c){var d={};this.getName=function(){return b};this.listen=function(b,c){if(b&&c)return d[b]||(d[b]=[]),d[b].push(c),c;else throw Error("Must provide a type and callback for CommServer listeners");};this.forget=function(b,c){if(c){var e=d[b].indexOf(c);if(e>-1)return c=d[b][e],d.splice(e,1),c}else delete d[b]};this.send=
function(b,c){c?e.postMessage(JSON.stringify({type:c,message:b}),"*"):e.postMessage(JSON.stringify(b),"*")};e.addEventListener("message",function(b){if(b.source===e){b=JSON.parse(b.data);if(b.type&&d[b.type])for(var h=d[b.type],i=0;i<h.length;++i)h[i](b.message);c&&c(b)}},!1)}var j={},b=this;this.bindFrame=function(h,e,c,d){e.addEventListener("load",function(f){b.bindClientWindow(h,e.contentWindow,d);c&&c(f)},!1)};this.bindWindow=function(h,e,c,d){e.addEventListener("load",function(f){b.bindClientWindow(h,
e,d);c&&c(f)},!1)};this.bindClientWindow=function(b,e,c){j[b]=new l(b,e,c)};this.listen=function(b,e,c){j[b]&&j[b].listen(e,c)};this.forget=function(b,e,c){j[b]&&j[b].forget(e,c)};this.send=function(b,e,c){j[b]&&j[b].send(e,c)}}}})})(window,document,void 0,Butter);
(function(t,q,k,m){m.registerModule("eventeditor",function(){var l,j,b,h,e,c,d,f={},u=function(a){function i(){h[b]("editorCommLink",g,function(){r.listen("trackeventupdated",k);r.listen("targetadded",function(){h.send("editorCommLink",r.getTargets(),"updatedomtargets")});h.listen("editorCommLink","okayclicked",function(b){a.popcornOptions=b;g.close&&g.close();g&&g.parentNode&&g.parentNode.removeChild(g);r.unlisten("trackeventupdated",k);r.trigger("trackeditclosed");r.trigger("trackeventupdated",
a)});h.listen("editorCommLink","applyclicked",function(b){a.popcornOptions=b;r.trigger("trackeventupdated",a)});h.listen("editorCommLink","deleteclicked",function(){r.removeTrackEvent(a);g.close&&g.close();g&&g.parentNode&&g.parentNode.removeChild(g);r.unlisten("trackeventupdated",k);r.trigger("trackeditclosed")});h.listen("editorCommLink","cancelclicked",function(){g.close&&g.close();g&&g.parentNode&&g.parentNode.removeChild(g);r.unlisten("trackeventupdated",k);r.trigger("trackeditclosed")});h.send("editorCommLink",
{trackEvent:a,targets:r.getTargets()},"edittrackevent")})}var g,r=this,n=f[a.type]||a.manifest.customEditor||j,k=function(a){h.send("editorCommLink",a.data.popcornOptions,"updatetrackevent")};if(l)for(;l.firstChild;)l.removeChild(l.firstChild);if(b==="bindWindow")g=d||t.open(n,"","width="+c+",height="+e+",menubar=no,toolbar=no,location=no,status=no"),i(),g.addEventListener("beforeunload",function(){r.unlisten("trackeventupdated",k);r.trigger("trackeditforcedclosed")},!1);else if(b==="bindFrame")g=
q.createElement("iframe"),i(),g.src=n,l.appendChild(g)},i=function(a,b){return{domtarget:function(a){if(typeof a==="string")return l=q.getElementById(a)||{};else if(a)return l=a},window:function(a){if(a)return d=a}}[b](a)};return{setup:function(a){if(!a||typeof a!=="object")throw Error("Invalid Argument");c=a.editorWidth||400;e=a.editorHeight||400;a.target&&i(a.target,"domtarget")||a.targetWindow&&i(a.targetWindow,"window");b=l?"bindFrame":"bindWindow";j=a.defaultEditor||"defaultEditor.html";h=new m.CommServer},
extend:{editTrackEvent:function(a){if(!a||!(a instanceof m.TrackEvent))return!1;this.trigger("trackeditstarted");u.call(this,a);return!0},addCustomEditor:function(a,b){if(!b||!a)return!1;return f[b]=a},removeCustomEditor:function(a,b){if(!b||!a)return!1;var c=f[b];f[b]=k;return c},changeEditorTarget:function(a,c){var d=["domtarget","window"],e;if(!a)return l=k,b="bindWindow",!0;if(!c||d.indexOf(e=c.toLowerCase())===-1)return!1;return i(a,e)},setDefaultEditor:function(a){if(!a||typeof a!=="string")return!1;
return j=a},setEditorDims:function(a){if(!a||!a.height&&!a.width)return!1;c=a.width||c;e=a.height||e;return a}}}}())})(window,document,void 0,Butter);
(function(t,q,k,m){var l,j,b,h,e,c,d,f,u,i;m.registerModule("previewer",{setup:function(a){u={};f=a.popcornURL||"http://popcornjs.org/code/dist/popcorn-complete.js";l=/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu|vimeo|soundcloud|baseplayer)/;layout=a.layout;butterIds={};c=a.media;i={};d={};var e=this,g=q.getElementById(a.target);if(g.tagName==="DIV")target=q.getElementById(a.target),b=q.createElement("IFRAME"),b.src=layout,b.width=target.style.width,b.height=target.style.height,target.appendChild(b),
b.addEventListener("load",function(){e.scraper(b,a.callback);this.removeEventListener("load",arguments.callee,!1)},!1);else if(g.tagName==="IFRAME")b=g,b.src=a.layout,g.addEventListener("load",function(){e.scraper(b,a.callback);this.removeEventListener("load",arguments.callee,!1)},!1)},extend:{scraper:function(a,b){function d(a){for(var b=0;b<a.length;b++)a[b].getAttribute("data-butter")==="target"?f.addTarget({name:a[b].id,type:"target"}):a[b].getAttribute("data-butter")==="media"&&f.addMedia({name:a[b].id,
media:c}),a[b].children.length>0&&d(a[b].children)}var e=a.contentWindow.document.getElementsByTagName("BODY"),f=this;m.extend(u,a.contentWindow.document.head);h="<body>"+a.contentWindow.document.body.innerHTML+"</body>\n";var i=function(){e.length<1?setTimeout(function(){i()},5):(d(e[0].children),b())};i()},buildPopcorn:function(a,c){j=this.getCurrentMedia().getMedia();a=a||this.getAllMedia()[0].getName();b.contentWindow.document.body.innerHTML=h;e="document.addEventListener('DOMContentLoaded', function () {\n";
var g=l.exec(j)||"",f=[],n=this;f.youtu=function(){b.contentWindow.document.getElementById(a).innerHTML="";d[n.getCurrentMedia().getId()]="popcorn"+n.getCurrentMedia().getId()+" = Popcorn( Popcorn.youtube( '"+a+"', '"+j+"', {\nwidth: 430, height: 300\n} ) );\n"};f["vimeo "]=function(){b.contentWindow.document.getElementById(a).innerHTML="";d[n.getCurrentMedia().getId()]="popcorn"+n.getCurrentMedia().getId()+" = Popcorn( Popcorn.vimeo( '"+a+"', '"+j+"', {\ncss: {\nwidth: '430px',\nheight: '300px'\n}\n} ) );\n"};
f.soundcloud=function(){b.contentWindow.document.getElementById(a).innerHTML="";d[n.getCurrentMedia().getId()]="popcorn"+n.getCurrentMedia().getId()+" = Popcorn( Popcorn.soundcloud( '"+a+"', '"+j+"' ) );\n"};f.baseplayer=function(){b.contentWindow.document.getElementById(a).innerHTML="";d[n.getCurrentMedia().getId()]="popcorn"+n.getCurrentMedia().getId()+" = Popcorn( Popcorn.baseplayer( '"+a+"' ) );\n"};f[k]=function(){var c=q.createElement("source"),e=q.createElement("video");c.src=j;e.style.width=
a.width;e.style.height=a.height;e.appendChild(c);e.controls=!0;e.id=a+"-butter";b.contentWindow.document.getElementById(a).appendChild(e);c="#"+e.id;d[n.getCurrentMedia().getId()]="popcorn"+n.getCurrentMedia().getId()+" = Popcorn( '"+c+"');\n"};f[g[1]]();for(video in d)e+=d[video];for(popcorn in i)if(g=i[popcorn].getTrackEvents())for(f=0;f<g.length;f++){var m=g[f]._natives.manifest.options;e+=" popcorn"+popcorn+"."+g[f]._natives.type+"({\n";for(item in m)m.hasOwnProperty(item)&&(e+=item+": '"+g[f][item]+
"',\n");e+="});"}e+="}, false);";this.fillIframe(c)},getPopcorn:function(){var a="var "+d;for(popcorn in i){var b=i[popcorn].getTrackEvents();if(b)for(var c=0;c<b.length;c++){var e=b[c]._natives.manifest.options;a+="popcorn"+popcorn+"."+b[c]._natives.type+"({\n";for(item in e)e.hasOwnProperty(item)&&(a+=item+": '"+b[c][item]+"',\n");a+="});\n"}}return a},fillIframe:function(a){var c,d,h=this,j=b.contentWindow.document;c=j.createElement("script");c.innerHTML=e;j.head.appendChild(c);c="<head>"+u.innerHTML+
"\n<script src='"+f+"'><\/script>\n<script>\n"+e+"<\/script>";c+="\n</head>\n";d=j.body.innerHTML;j.open();j.write("<html>\n"+c+d+"\n</html>");j.close();var k=function(a,c){var d=b.contentWindow["popcorn"+h.getCurrentMedia().getId()];d?c&&c(d):setTimeout(function(){k(a,c)},10)};k(null,function(a){var b=function(){a.media.readyState>=2||a.media.duration>0?(h.duration(a.media.duration),h.trigger("videoReady",h.getCurrentMedia())):setTimeout(function(){b(a)},10)};b(a)});this.teAdded=function(c){var d=
this,e=c.data;k(e,function(c){i[d.getCurrentMedia().getId()]?c=i[d.getCurrentMedia().getId()]:i[d.getCurrentMedia().getId()]=c;c[e.type](b.contentWindow.Popcorn.extend({},e.popcornOptions));butterIds[e.getId()]=c.getLastTrackEventId();e.manifest=c.getTrackEvent(butterIds[e.getId()])._natives.manifest;a&&a()})};this.listen("trackeventadded",this.teAdded);this.listen("trackeventremoved",function(a){b.contentWindow.popcorn.removeTrackEvent(butterIds[a.data.getId()])});this.listen("mediachanged",function(a){h.buildPopcorn(a.data.getName())});
this.listen("timeupdate",function(a){b.contentWindow["popcorn"+h.getCurrentMedia().getId()].video.currentTime=a.data;h.currentTime(b.contentWindow["popcorn"+h.getCurrentMedia().getId()].video.currentTime)})}}})})(window,document,void 0,Butter);
Butter.registerModule("timeline",{setup:function(t){var q=function(b){var d=new Date(1970,0,1);d.setSeconds(b);b=d.toTimeString().substr(0,8);b>86399&&(b=Math.floor((d-Date.parse("1/1/70"))/36E5)+b.substr(2));return b},k=!1,m=0,l=function(b){var d=this;this.container=document.createElement("div");this.container.style.width="100%";this.container.style.position="relative";this.container.style.MozUserSelect="none";this.container.style.webkitUserSelect="none";this.container.style.oUserSelect="none";this.container.style.userSelect=
"none";h.appendChild(this.container);this.tracks=document.createElement("div");this.tracks.style.width="100%";this.init=function(){this.duration=b.getDuration();this.trackLine=new TrackLiner({element:this.tracks,dynamicTrackCreation:!0,scale:1,duration:this.duration,restrictToKnownPlugins:!0});this.butterTracks={};this.trackLinerTracks={};this.butterTrackEvents={};this.trackLinerTrackEvents={};this.timeline=document.createElement("canvas");this.timeline.style.height="25px";this.timeline.style.width=
this.container.offsetWidth+"px";this.timeline.height="25";this.timeline.width=this.container.offsetWidth;this.scrubber=document.createElement("div");this.scrubber.style.height="100%";this.scrubber.style.width="1px";this.scrubber.style.position="absolute";this.scrubber.style.top="0";this.scrubber.style.left="0";this.scrubber.style.zIndex=this.timeline.style.zIndex+1;this.scrubber.style.backgroundColor="red";this.userInteract=document.createElement("div");this.userInteract.style.position="absolute";
this.userInteract.style.top="0";this.userInteract.style.left="0";this.userInteract.style.height=this.timeline.style.height;this.userInteract.style.width="100%";this.userInteract.style.zIndex=this.scrubber.style.zIndex+1;this.userInteract.addEventListener("mousemove",function(a){m=a.rangeParent.scrollLeft},!1);this.userInteract.addEventListener("mousedown",function(a){k=!0;d.scrubber.style.left=a.pageX-(d.container.offsetLeft-a.rangeParent.scrollLeft);e.currentTime((a.pageX-(d.container.offsetLeft-
m)+d.container.scrollLeft)/d.container.offsetWidth*this.duration)},!1);this.container.appendChild(this.scrubber);this.container.appendChild(this.userInteract);this.container.appendChild(this.timeline);this.container.appendChild(this.tracks);var f=this.timeline.getContext("2d"),h=this.container.offsetWidth/this.duration/4,i=[10,4,7,4],a=f.measureText(q(5)).width,j=-a/2;f.translate(0.5,0.5);f.beginPath();for(var g=1,l=this.duration*4;g<l;g++){var n=g*h;f.moveTo(-~n,0);f.lineTo(-~n,i[g%4]);g%4===0&&
n-j>a&&(j=n,f.fillText(q(g/4),-~n-a/2,21))}f.stroke();f.closePath()};this.hide=function(){this.container.style.display="none"};this.show=function(){this.container.style.display="block"}},j=[],b,h=document.getElementById(t.target)||t.target,e=this;TrackLiner.plugin("butterapp",{setup:function(c,d,f,h){if(h){f=c;if(!b.butterTracks[c.id()])b.trackLine.removeTrack(f),e.addTrack(new Butter.Track),f=b.lastTrack;b.lastTrack=f;var f=d.left/b.container.offsetWidth*b.duration,i=f+4;e.addTrackEvent(b.butterTracks[b.lastTrack.id()],
new Butter.TrackEvent({popcornOptions:{start:f,end:i},type:h.draggable[0].id}))}else return f=d.popcornOptions.start,i=d.popcornOptions.end,h=(i-f)/b.duration*c.getElement().offsetWidth,{left:f/b.duration*c.getElement().offsetWidth,innerHTML:d.type,width:h}},moved:function(c,d){var f=c;d.options.popcornOptions.start=d.element.offsetLeft/b.container.offsetWidth*b.duration;d.options.popcornOptions.end=(d.element.offsetLeft+d.element.offsetWidth)/b.container.offsetWidth*b.duration;if(!b.butterTracks[c.id()])b.trackLine.removeTrack(f),
e.addTrack(new Butter.Track),f=b.lastTrack,f.addTrackEvent(d);b.lastTrack=f;e.trigger("trackeventupdated",d.options)},click:function(){},dblclick:function(b,d){e.editTrackEvent&&e.editTrackEvent(d.options)}});document.addEventListener("mousemove",function(c){if(k)c.pageX>b.container.offsetLeft-m&&c.pageX<b.container.offsetLeft-m+b.container.offsetWidth?(b.scrubber.style.left=c.pageX-(b.container.offsetLeft-m),e.currentTime((c.pageX-(b.container.offsetLeft-m)+b.container.scrollLeft)/b.container.offsetWidth*
b.duration)):c.pageX<=b.container.offsetLeft-m?(b.scrubber.style.left=0,e.currentTime(0)):(b.scrubber.style.left=b.container.offsetWidth,e.currentTime(b.duration))},!1);document.addEventListener("mouseup",function(){k=!1},!1);this.listen("timeupdate",function(){b.scrubber.style.left=e.currentTime()/b.duration*b.container.offsetWidth});this.listen("trackadded",function(c){var c=c.data,d=b.trackLine.createTrack();b.trackLinerTracks[c.getId()]=d;b.lastTrack=d;b.butterTracks[d.id()]=c});this.listen("trackremoved",
function(c){var c=c.data,d=b.trackLinerTracks[c.getId()],f=d.getTrackEvents(),h;for(h in f)f.hasOwnProperty(h)&&e.removeTrackEvent(c,b.butterTrackEvents[f[h].element.id]);b.trackLine.removeTrack(d);delete b.butterTracks[d.id()];delete b.trackLinerTracks[c.getId()]});this.listen("trackeventadded",function(c){var c=c.data,d=b.lastTrack.createTrackEvent("butterapp",c);b.trackLinerTrackEvents[c.getId()]=d;b.butterTrackEvents[d.element.id]=c});this.listen("trackeventremoved",function(c){var c=c.data,d=
b.trackLinerTrackEvents[c.getId()],e=b.trackLine.getTrack(d.trackId);(b.lastTrack=e)&&e.removeTrackEvent(d.element.id);delete b.butterTrackEvents[d.element.id];delete b.trackLinerTrackEvents[c.getId()]});this.listen("mediaadded",function(b){j[b.data.getId()]=new l(b.data)});this.listen("mediaready",function(b){j[b.data.getId()].init()});this.listen("mediachanged",function(c){b&&b.hide();(b=j[c.data.getId()])&&b.show()});this.listen("mediaremoved",function(b){delete j[b.data.getId()]});this.listen("trackeventupdated",
function(c){var c=c.data,d=b.trackLinerTrackEvents[c.getId()];trackLinerTrack=b.trackLine.getTrack(d.trackId);delete b.butterTrackEvents[d.element.id];trackLinerTrack.removeTrackEvent(d.element.id);d=trackLinerTrack.createTrackEvent("butterapp",c);b.butterTrackEvents[d.element.id]=c;b.trackLinerTrackEvents[c.getId()]=d})}});
(function(t,q,k,m){var l,j;m.registerModule("test",{setup:function(){console.log("Instance:",this.id);this.listen("test",function(b){console.log("Test event fired:",b)})},extend:{openTest:function(){if(!l||l.closed)l=t.open(m.getScriptLocation()+"modules/test-window.html","test","status=0 toolbar=0 width=500 height=500"),l.addEventListener("load",function(){j=l.document.getElementById("test-div")},!1)},closeTest:function(){l&&(l.close(),j=l=null)},speakTest:function(){if(l&&j){var b=Math.random()>
0.5?"Boop! ":"Beep! ";j.innerHTML+=b;this.trigger("test",b)}}}})})(window,document,void 0,Butter);
