<html>
<head>
<script src="http://popcornjs.org/code/dist/popcorn-complete.js"></script>
<script src="../lib/butter.js"></script>
<script>
  document.addEventListener( "DOMContentLoaded", function(){
    var popcorn = Popcorn( document.getElementById('outerVideo') );
    var b = new Butter();
    b.comm();
    var commClient = new b.CommClient( "previewerClient", function ( message ) {
      console.log('in preview', message);
    } );
    commClient.listen( "ping", function( message ) {
      commClient.send( Popcorn.instances.indexOf( popcorn ), "pong" );
    });
    commClient.listen( "trackeventadded", function ( message ) {
      console.log('trackeventadded!!!!!!', message);
      popcorn[ message.type ]( Popcorn.extend( {}, message.popcornOptions ) ); 
      commClient.send( { butterId: message.id, popcornId: popcorn.getLastTrackEventId() }, "trackeventadded" );
    });

    
  }, false );
</script>
</head>
<body>
  <div id="div1">
    <video data-butter="media" id="outerVideo">
      <source src="../../popcorn-js/test/trailer.ogv"/>
    </video>
    <div data-butter="target" id="div2" style="position:relative;float:left;width:400px;"></div>
  </div>
</body>
</html>
